{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";var _excluded=[\"children\"],_excluded2=[\"manageFocus\",\"defaultValue\",\"value\",\"space\",\"onChange\"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}import React from'react';import{HStack}from\"../../primitives/Stack\";import{useThemeProps}from\"../../../hooks\";import{useFormControlContext}from\"../FormControl\";import Platform from\"react-native-web/dist/exports/Platform\";import{PinInputContext}from\"./Context\";import{themeTools}from\"../../../theme\";import{useHasResponsiveProps}from\"../../../hooks/useHasResponsiveProps\";var PinInput=function PinInput(_ref,ref){var children=_ref.children,props=_objectWithoutProperties(_ref,_excluded);var _themeTools$extractIn=themeTools.extractInObject(props,['p','px','py','pt','pb','pl','pr']),_themeTools$extractIn2=_slicedToArray(_themeTools$extractIn,2),padding=_themeTools$extractIn2[0],remProps=_themeTools$extractIn2[1];var _useThemeProps=useThemeProps('PinInput',remProps),manageFocus=_useThemeProps.manageFocus,defaultValue=_useThemeProps.defaultValue,value=_useThemeProps.value,space=_useThemeProps.space,onChange=_useThemeProps.onChange,newProps=_objectWithoutProperties(_useThemeProps,_excluded2);var formControlContext=useFormControlContext();var RefList=[];var setRefList=function setRefList(ref,index){RefList[index]=ref;};var _React$useState=React.useState(value||defaultValue),_React$useState2=_slicedToArray(_React$useState,2),pinInputValue=_React$useState2[0],setPinInputValue=_React$useState2[1];var handleChange=function handleChange(newValue,fieldIndex){var temp=pinInputValue&&_toConsumableArray(pinInputValue)||[];temp[fieldIndex]=newValue;value===undefined&&setPinInputValue(temp.join(''));onChange&&onChange(temp.join(''));if(newValue===''&&manageFocus&&fieldIndex-1>-1)RefList[fieldIndex-1].current.focus();else if(newValue&&manageFocus&&fieldIndex+1<RefList.length)RefList[fieldIndex+1].current.focus();return temp.join('');};var handleMultiValueChange=function handleMultiValueChange(newValue,fieldIndex){var pinFieldLength=RefList.length;var newValueLength=newValue.length;if(newValueLength>=pinFieldLength&&newValueLength>2){var splicedValue=newValue?_toConsumableArray(newValue):[];splicedValue.splice(pinFieldLength);RefList[pinFieldLength-1].current.focus();setPinInputValue(splicedValue.join(''));onChange&&onChange(splicedValue.join(''));}if(Platform.OS!=='ios'){var temp=pinInputValue?_toConsumableArray(pinInputValue):[];if(newValue===''){temp=temp.filter(function(_n,i){return i!==fieldIndex;});if(manageFocus&&fieldIndex-1>-1)RefList[fieldIndex-1].current.focus();}else{temp[fieldIndex]=JSON.stringify(parseInt(newValue,10)%10);if(manageFocus&&fieldIndex+1<RefList.length)RefList[fieldIndex+1].current.focus();}value===undefined&&setPinInputValue(temp.join(''));onChange&&onChange(temp.join(''));}};var indexSetter=function indexSetter(allChildren){var pinInputFiledCounter=-1;return React.Children.map(allChildren,function(child){pinInputFiledCounter++;return React.cloneElement(child,{fieldIndex:pinInputFiledCounter},child.props.children);});};React.useEffect(function(){if(value!==undefined&&value!=pinInputValue)setPinInputValue(value);},[value,pinInputValue,setPinInputValue]);if(useHasResponsiveProps(props)){return null;}return React.createElement(PinInputContext.Provider,{value:_objectSpread(_objectSpread(_objectSpread({},formControlContext),newProps),{},{setRefList:setRefList,handleChange:handleChange,handleMultiValueChange:handleMultiValueChange,value:pinInputValue})},children&&React.createElement(HStack,_extends({flexDirection:\"row\",space:space},padding,{ref:ref}),indexSetter(children)));};export default React.memo(React.forwardRef(PinInput));","map":{"version":3,"sources":["PinInput.tsx"],"names":["PinInput","props","themeTools","newProps","useThemeProps","formControlContext","useFormControlContext","RefList","setRefList","React","value","handleChange","temp","pinInputValue","setPinInputValue","onChange","newValue","fieldIndex","handleMultiValueChange","pinFieldLength","newValueLength","splicedValue","Platform","i","manageFocus","JSON","parseInt","indexSetter","allChildren","pinInputFiledCounter","child","useHasResponsiveProps","children","space","ref"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { HStack } from '../../primitives/Stack';\nimport { useThemeProps } from '../../../hooks';\nimport type { IPinInputProps } from './types';\nimport { useFormControlContext } from '../FormControl';\nimport { Platform } from 'react-native';\nimport { PinInputContext } from './Context';\nimport { themeTools } from '../../../theme';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\n\nconst PinInput = ({ children, ...props }: IPinInputProps, ref?: any) => {\n  let [padding, remProps] = themeTools.extractInObject(props, [\n    'p',\n    'px',\n    'py',\n    'pt',\n    'pb',\n    'pl',\n    'pr',\n  ]);\n  const {\n    manageFocus,\n    defaultValue,\n    value,\n    space,\n    onChange,\n    ...newProps\n  } = useThemeProps('PinInput', remProps);\n  const formControlContext = useFormControlContext();\n\n  const RefList: Array<any> = [];\n  const setRefList = (ref: any, index: number) => {\n    RefList[index] = ref;\n  };\n  const [pinInputValue, setPinInputValue] = React.useState(\n    value || defaultValue\n  );\n\n  const handleChange = (newValue: string, fieldIndex: number) => {\n    let temp = (pinInputValue && [...pinInputValue]) || [];\n    temp[fieldIndex] = newValue;\n    value === undefined && setPinInputValue(temp.join(''));\n    onChange && onChange(temp.join(''));\n    if (newValue === '' && manageFocus && fieldIndex - 1 > -1)\n      RefList[fieldIndex - 1].current.focus();\n    else if (newValue && manageFocus && fieldIndex + 1 < RefList.length)\n      RefList[fieldIndex + 1].current.focus();\n    return temp.join('');\n  };\n  const handleMultiValueChange = (newValue: string, fieldIndex: number) => {\n    const pinFieldLength = RefList.length;\n    const newValueLength = newValue.length;\n    if (newValueLength >= pinFieldLength && newValueLength > 2) {\n      let splicedValue = newValue ? [...newValue] : [];\n      splicedValue.splice(pinFieldLength);\n      RefList[pinFieldLength - 1].current.focus();\n      setPinInputValue(splicedValue.join(''));\n      onChange && onChange(splicedValue.join(''));\n    }\n\n    if (Platform.OS !== 'ios') {\n      let temp = pinInputValue ? [...pinInputValue] : [];\n      if (newValue === '') {\n        // Handling Backward focus.\n        temp = temp.filter((_n, i) => i !== fieldIndex);\n        if (manageFocus && fieldIndex - 1 > -1)\n          RefList[fieldIndex - 1].current.focus();\n      } else {\n        temp[fieldIndex] = JSON.stringify(parseInt(newValue, 10) % 10);\n        if (manageFocus && fieldIndex + 1 < RefList.length)\n          RefList[fieldIndex + 1].current.focus();\n      }\n      value === undefined && setPinInputValue(temp.join(''));\n      onChange && onChange(temp.join(''));\n    }\n  };\n\n  const indexSetter = (allChildren: JSX.Element | JSX.Element[]) => {\n    let pinInputFiledCounter = -1;\n    return React.Children.map(allChildren, (child: JSX.Element) => {\n      pinInputFiledCounter++;\n      return React.cloneElement(\n        child,\n        {\n          fieldIndex: pinInputFiledCounter,\n        },\n        child.props.children\n      );\n    });\n  };\n\n  React.useEffect(() => {\n    if (value !== undefined && value != pinInputValue) setPinInputValue(value);\n  }, [value, pinInputValue, setPinInputValue]);\n\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(props)) {\n    return null;\n  }\n\n  return (\n    <PinInputContext.Provider\n      value={{\n        ...formControlContext,\n        ...newProps,\n        setRefList,\n        handleChange,\n        handleMultiValueChange,\n        value: pinInputValue,\n      }}\n    >\n      {children && (\n        <HStack flexDirection=\"row\" space={space} {...padding} ref={ref}>\n          {indexSetter(children)}\n        </HStack>\n      )}\n    </PinInputContext.Provider>\n  );\n};\n\nexport default React.memo(React.forwardRef(PinInput));\n"]},"metadata":{},"sourceType":"module"}